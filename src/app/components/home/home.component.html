<mat-card id="container" class="mat-elevation-z4">
  <mat-tab-group dynamicHeight mat-align-tabs="center" [selectedIndex]='selectedTab' (animationDone)="showSearch()">
    <mat-tab label="Filter Data">
      <form class="formContainer">
        <mat-slide-toggle color="primary" [checked]="showPrices" (change)="toggleShowPrices()">
          Housing Prices
        </mat-slide-toggle>

        <mat-slide-toggle color="warn" [checked]="showTraffic" (change)="toggleShowTraffic()">
          Traffic Data
        </mat-slide-toggle>

        <mat-button-toggle-group name="fontStyle" aria-label="Font Style" value="traffic" (change)="toggleData()">
          <mat-button-toggle value="traffic" class="toggleContainer">
            <button mat-button color="warn" class="toggles">
              Traffic Data
            </button>
          </mat-button-toggle>
          <mat-button-toggle value="prices" class="toggleContainer">
            <button mat-button color="primary" class="toggles">
              Housing Prices
            </button>
          </mat-button-toggle>
        </mat-button-toggle-group>

        <mat-form-field>
          <mat-select #areaSelector placeholder="Filter Portland Area">
            <mat-option *ngFor="let area of objectKeys(areas)" [value]="areas[area]">{{area}}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-select #yearSelector placeholder="Filter Year">
            <mat-option *ngFor="let year of years" [value]="year">{{year}}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field id="hideVehicle">
          <mat-select #vehicleSelector placeholder="Filter Vehicle Type">
            <mat-option *ngFor="let vehicle of vehicles" [value]="vehicle">{{vehicle}}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-select #densitySelector placeholder="Filter Traffic Density">
            <mat-option *ngFor="let density of densities" [value]="density">{{density}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <button id="resetButton" mat-raised-button color="warn" (click)="clearFiltersAndUpdateMap()">Clear Filters
        </button>
        <button mat-raised-button color="primary" (click)="updateMap()">Filter Data</button>
      </form>
    </mat-tab>

    <mat-tab label="Search Address">
      <form class="formContainer">
        <mat-form-field id="searchBar">
          <input type="text" id="addressSearch" (keyup)="autocompleteAddress($event)" placeholder="Enter Address" aria-label="Address" matInput [formControl]="autocompleteFormControl" [matAutocomplete]="auto">
          <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
            <mat-option *ngFor="let option of options" [value]="option">{{option}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <button mat-raised-button color="primary" (click)="getZestimate()">Search</button>

        <mat-card id="errorMessage">
          <mat-card-content><strong>Error, cannot find address</strong></mat-card-content>
        </mat-card>

        <mat-card id="infoCard">
          <mat-card-header>
            <mat-card-title>{{currentAddressTextContent}}</mat-card-title>
            <mat-card-subtitle>{{cityZipTextContent}}</mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <mat-accordion>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>{{zestimateTextContent}}</mat-panel-title>
                </mat-expansion-panel-header>
                <p>A ZestimateÂ® home valuation is Zillow's estimated market value. It is not an appraisal. Use it as a
                  starting point to determine a home's value.</p>
              </mat-expansion-panel>

              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>{{trafficLevelTextContent}}</mat-panel-title>
                </mat-expansion-panel-header>

                <p>{{trafficVolumeTextContent}}</p>
                <ul>
                  <li>Low: Less than 1000 cars</li>
                  <li>Medium: More than 1000 cars and less than 5000 cars</li>
                  <li>High: More than 5000 cars</li>
                </ul>
              </mat-expansion-panel>

              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>{{projectsTextContent}}</mat-panel-title>
                </mat-expansion-panel-header>
                <p>{{tspProjectsTextContent}}</p>
              </mat-expansion-panel>
            </mat-accordion>
          </mat-card-content>
          <mat-card-actions>
            <button mat-button (click)="saveSearch()" [disabled]="loggedIn">SAVE</button>
          </mat-card-actions>
        </mat-card>
      </form>
    </mat-tab>
  </mat-tab-group>

  <div id="map" class="mat-elevation-z4" leaflet
      (leafletMapReady)="onMapReady($event)" (leafletMapMoveEnd)="updateHeatMap()" [leafletOptions]="leafletOptions">
  </div>

  <div id="keys">
    <img class="keyImage" src="assets/images/traffic.png">
    <img class="keyImage" src="assets/images/prices.png">
  </div>
  
</mat-card>
